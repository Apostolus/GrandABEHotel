$("#reservation-form").submit(function(event){
	event.preventDefault();
	var destination = "http://localhost/GrandABEHotel/reservation";

	$(this).children(".form-loading-disabled").addClass("form-loading-active");
	$(this).children(".form-loading-disabled").removeClass("form-loading-disabled");

	// Send the AJAX Request
	$.ajax({
		type: "POST",
		url: destination,
		data: $("#reservation-form").serialize(),
		timeout: 5000,
		fail: function()
		{
			console.log("fail");
			$("#reservation-form").children(".form-loading-active").addClass("form-loading-disabled");
			$("#reservation-form").children(".form-loading-active").removeClass("form-loading-active");
		},
		success: function(data)
		{
			console.log("success");
			console.log(data);
			
			// Parse JSON data
			data = JSON.parse(data);
			
			// Disable the loading overlay
			$("#reservation-form").children(".form-loading-active").addClass("form-loading-disabled");
			$("#reservation-form").children(".form-loading-active").removeClass("form-loading-active");
			
			// Check out all form error divs if the form is error
			var errorIndex;
			if (data.success === false) {
				$(".form-group").each(function(i, obj){
					var currentField = $(this).data("for");
					if (data.error_message.hasOwnProperty(currentField))
					{
						$(this).children(".form-error").html(data.error_message[currentField]);
					}
					else
					{
						$(this).children(".form-error").html("");
					}
				});

				$("#form-notification").html('\
					<div class="alert alert-warning alert-dismissible" role="alert">\
						<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\
						' + data.error_title + '\
					</div>\
				');
			}

			else {
				$("#form-notification").html('\
				<div class="alert alert-success alert-dismissible" role="alert">\
						<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\
						<b>' + data.success_title + '</b><br>' + data.success_message + '\
					</div>\
				');
			}
		}
	});
});


var userList = new List('users');
